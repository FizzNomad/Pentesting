# Import the Active Directory module
Import-Module ActiveDirectory

# Define the date range for user accounts
$startDate = Get-Date -Year 2018 -Month 1 -Day 1
$endDate = Get-Date -Year 2021 -Month 12 -Day 31

# Specify the distinguished name of the Disabled Users OU
$disabledUsersOU = "OU=Disabled Users,DC=yourdomain,DC=com"

# Get all AD user accounts created within the specified date range
$users = Get-ADUser -Filter {Created -ge $startDate -and Created -le $endDate} -Properties Created, DistinguishedName

# Filter out the users that are members of the Disabled Users OU
$filteredUsers = $users | Where-Object { $_.DistinguishedName -notlike "*,$disabledUsersOU" }

# Export the results to a CSV file
$filteredUsers | Select-Object Name, SamAccountName, Created, DistinguishedName | Export-Csv -Path "FilteredUsers.csv" -NoTypeInformation
